{% load static %} 
{% block content %}
<!-- DataTables -->

<div id="content_traslado">
    <div id="addTraslado" style="display: none;">
        <div class="stackbox-header cab_popup" align="center">
            <img src="{% static 'image/favicon.ico' %}" width="40px" style="float:left;margin-top: -5px;" />
            <h id="tituloTras"> </h> Traslado/Traspasos/Cambios Administrativos</div>
        <div class="stackbox-body" id="bodyaddTraslado">
            <input type="hidden" id="idTraslado" name="idTraslado" value="" />
            <input type="hidden" id="tipot_tras" value="0" />
            <input type="hidden" id="idTrasAcc" name="idIngAccI" value="" />
            <input type="hidden" id="bandTrasSP" name="bandIngSP" value="" />
            <input type="hidden" id="idaccPerT" name="idaccPerI" value="" />
            <input type="hidden" id="idFuncionarioT" name="idFuncionarioT" value="" />
            <section class="content">
                <div class="row" style="box-shadow: 5px 5px 5px 5px #888888; width: 102%; margin-top: 20px;">
                    <div class="notification">
                        <span class="icon">
                            <i class=""></i>
                        </span>
                        <span class="text"></span>
                        <span class="close"><i class="fa fa-close"></i></span>
                    </div>
                    <!--fin notificacion-->
                    <br>
                    <div class="col-xs-12">
                        <div class="nav-tabs-custom">
                            <ul class="nav nav-tabs">
                                <li class="active"><a href="#tab_funcionarioT" data-toggle="tab" aria-expanded="true" style="font-weight: bold;">Funcionario</a></li>
                                <li class=""><a href="#tab_newPuestoT" data-toggle="tab" aria-expanded="false" style="font-weight: bold;display: none;">Nuevo Puesto</a></li>
                                <!--li class=""><a href="#tab_periodoT" data-toggle="tab" aria-expanded="false" style="font-weight: bold;">Periodo</a></li-->
                                <!--li class=""><a href="#tab_historialIST" data-toggle="tab" aria-expanded="false" style="font-weight: bold;">Historial Ingresos/Salidas</a></li-->
                                <li class=""><a href="#tab_historialTT" data-toggle="tab" aria-expanded="false" style="font-weight: bold;" onclick="verHistorialTras();">Historial Traslados</a></li>
                            </ul>
                            <div class="tab-content" style="border-top: 2px solid #3c8dbc;">
                                <!-- Font Awesome Icons -->
                                <div class="tab-pane active" id="tab_funcionarioT">
                                    <div class="row">
                                        <div class="col-xs-12">
                                            <div style="border-bottom:2px solid #3c8dbc;font-size: 14px;box-shadow: 1px 5px 5px;"><i class="fa fa-fw fa-user"></i> Datos Generales</div>
                                            <br>
                                            <div class="col-xs-6 callout" style="border-color: #1b90ad;">
                                                <table>
                                                    <tr>
                                                        <td style="text-align: left;">Funcionario</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <input type="text" name="nombre_funcT" id="nombre_funcT" class="form-control" readonly>
                                                        </td>
                                                    </tr>
                                                    <tr height="10px;"> </tr>
                                                    <tr>
                                                        <td style="text-align: left;">Identificación</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <input type="text" name="ced_funcT" id="ced_funcT" class="form-control" readonly>
                                                        </td>
                                                    </tr>
                                                    <tr height="10px;"> </tr>
                                                    <tr>
                                                        <td style="text-align: left;">Tipo Movimiento</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <input type="text" name="tipomovT" id="tipomovT" class="form-control" readonly>
                                                        </td>
                                                    </tr>
                                                    <tr height="10px;"> </tr>
                                                    <tr>
                                                        <td style="text-align: left;">#Memorandum</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <input type="text" id="num_memoT" class="form-control" style="width: 300px;" readonly/>
                                                        </td>
                                                    </tr>

                                                </table>
                                            </div>
                                            <div class="col-xs-6 callout" style="border-color: #1b90ad;">
                                                <table>
                                                    <tr>
                                                        <td style="text-align: left;">#Acción Personal</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <input type="text" name="acc_PerT" id="acc_PerT" class="form-control" readonly style="width: 300px;">
                                                        </td>
                                                    </tr>
                                                    <tr height="10px;"> </tr>
                                                    <tr>
                                                        <td style="text-align: left;">Fecha Acción
                                                            <br>Personal</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <input type="date" id="fecha_accPerT" class="form-control" readonly style="width: 300px%;" />
                                                        </td>
                                                    </tr>
                                                    <tr height='10px;'></tr>
                                                    <tr>
                                                        <td style="text-align: left;">Archivo
                                                            <br>Memo</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <!--input type="file" id="f_memoT" name="myfile" style="width: 300px;"/-->
                                                            <div id="contentFile2" style="margin-left: 20px;"><img id="imgContentFile2SP" src="" width="50px" />
                                                                <a style="margin-left: 10px; color: black; cursor: pointer;" id="nombreFile2SP"></a>
                                                            </div>
                                                        </td>
                                                    </tr>

                                                </table>
                                            </div>
                                        </div>
                                        <div class="col-xs-12" style="top: -15px;">
                                            <label>Observación</label>
                                            <textarea id="observacion_tras" class="form-control" rows="3" style="width: 300px%;"></textarea>
                                        </div>
                                        <br>
                                        <br>
                                        <div class="col-xs-12">

                                            <div style="border-bottom:2px solid #3c8dbc;font-size: 14px;box-shadow: 1px 5px 5px;"><i class="fa fa-fw fa-file-text"></i> Puesto Actual</div>
                                            <br>
                                            <table class="table" style="box-shadow: 5px 5px 5px 5px;text-transform: uppercase;font-size: 10px;">
                                                <thead>
                                                    <tr style="background-color: #3c8dbc; color:#fff;">
                                                        <td></td>
                                                        <td style="border: 1px solid black;text-align: center;">Dirección</td>
                                                        <td style="border: 1px solid black;text-align: center;">Proceso</td>
                                                        <td style="border: 1px solid black;text-align: center;">Subproceso</td>
                                                        <td style="border: 1px solid black;text-align: center;">Puesto Institucional</td>
                                                        <td style="border: 1px solid black;text-align: center;">Grupo Ocupacional</td>
                                                    </tr>
                                                </thead>
                                                <tbody id="tbody_puesto_act_trasp"></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <!-- /#fa-icons -->

                                <!-- glyphicons-->
                                <div class="tab-pane" id="tab_newPuestoT">
                                    <div class="row">
                                        <br>
                                        <br>
                                        <div class="col-xs-12">
                                            <div style="border-bottom:2px solid #3c8dbc;font-size: 14px;box-shadow: 1px 5px 5px;"><i class="fa fa-fw fa-arrow-circle-right"></i> Nuevo Puesto</div>
                                            <br>
                                            <div class="col-xs-6 callout" style="border-color: #1b90ad;">
                                                <table>
                                                    <tr>
                                                        <td style="text-align: left;">Dirección</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <select id="SdireccionT" class="select2" style="width: 300px;">
                                                                <option value=""> Seleccione una Opción</option>

                                                            </select>
                                                        </td>
                                                    </tr>
                                                    <tr height='10px;'></tr>
                                                    <tr>
                                                        <td style="text-align: left;">Proceso</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <select id="SprocesoT" class="select2" style="width: 300px;">
                                                                <option value=""> Seleccione una Opción</option>

                                                            </select>
                                                        </td>
                                                    </tr>
                                                    <tr height='10px;'></tr>
                                                    <tr>
                                                        <td style="text-align: left;">Subproceso</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <select id="SsubprocesoT" class="select2" style="width: 300px;">
                                                                <option value="0">Seleccione una Opción</option>

                                                            </select>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>
                                            <div class="col-xs-6 callout" style="border-color: #1b90ad;">
                                                <table>
                                                    <tr>
                                                        <td align="left">Puesto Institucional</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <select id="SpuestoT" class="select2" style="width: 300px;">
                                                                <option value=""> Seleccione una Opción</option>
                                                                {% for ginstitucional in ginstitucionals %}
                                                                <option value="{{ ginstitucional.id }}">{{ ginstitucional.nombre }}</option>
                                                                {% endfor %}
                                                            </select>
                                                        </td>
                                                    </tr>
                                                    <tr height='10px;'></tr>
                                                    <tr>
                                                        <td align="left">Grupo Ocupacional </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <select id="SpuestoDistT" class="select2" style="width: 300px;">
                                                                <option value=""> Seleccione una Opción</option>
                                                                {% for gocupacional in gocupacionals %}
                                                                <option value="{{ gocupacional.id }}">{{ gocupacional.nombre }}</option>
                                                                {% endfor %}
                                                            </select>
                                                            </select>
                                                        </td>
                                                    </tr>
                                                    <tr height='10px;'></tr>
                                                    <tr>
                                                        <td align="left">Cargo Funcional</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <select id="ScargoT" class="select2" style="width: 300px;">
                                                                <option value=""> Seleccione una Opción</option>

                                                            </select>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <!--fin tab_datosI-->
                                <!-- /#ion-icons -->

                                <!-- glyphicons-->
                                <div class="tab-pane" id="tab_historialTT">
                                    <div class="row">
                                        <br>
                                        <br>
                                        <div class="col-xs-12">
                                            <input type="hidden" id="cont_histTr" value="0">
                                            <div style="border-bottom:2px solid #3c8dbc;font-size: 14px;box-shadow: 1px 5px 5px;"><i class="fa fa-fw fa-file-text"></i> Historial Traslados</div>
                                            <br>
                                            <table class="table" style="box-shadow: 5px 5px 5px 5px;font-size: 10px;">
                                                <thead>
                                                    <tr style="background-color: #3c8dbc; color:#fff; text-align: center; text-transform: uppercase;">
                                                        <td style="border: 1px solid black;">Dirección</td>
                                                        <td style="border: 1px solid black;">Proceso</td>
                                                        <td style="border: 1px solid black;">Subproceso</td>
                                                        <td style="border: 1px solid black;">Puesto Institucional</td>
                                                        <td style="border: 1px solid black;">Puesto Ocupacional</td>
                                                        <td style="border: 1px solid black;">Fecha Inicio</td>
                                                    </tr>
                                                    <thead>
                                                        <tbody id="bodyHistTr" style="font-size: 10px;">
                                                        </tbody>
                                            </table>

                                        </div>
                                    </div>
                                </div>
                                <!--fin tab_datosI-->
                                <!-- /#ion-icons -->

                                <!-- /.tab-content -->
                            </div>
                            <!-- /.nav-tabs-custom -->
                        </div>
                        <!-- /.col -->
                    </div>
                    <!-- /.row -->
                </div>
            </section>
        </div>
        <!-- /.body -->
        <div class="stackbox-footer">
            <button class="btn btn-primary" id="btn_accTraslado" onclick="saveEditTraslado_SP();">Grabar</button>
            <button class="btn btn-default" data-close-stackbox="true">Close</button>
        </div>
    </div>

    <div class="box">
        <div class="box-header">
            <i class="fa fa-list"></i>
            <h3 class="box-title">Lista de Traslados/Traspasos/Cambios Administrativos</h3>
            <div class="botonera" style="float: right; right: 1px;">
                <a title="pfd" onclick="generarPdf('tabla_traslado_SP',13,1)"><i class="fa fa-file-pdf-o text-green"></i></a>
                <a title="excel" onclick="generarExcel('tabla_traslado_SP',13)"><i class="fa fa-file-excel-o text-green"></i></a>
            </div>
        </div>
        <!-- /.box-header -->

        <div class="box box-solid bg-light-blue-gradient">
            <div class="box-header ui-sortable-handle" style="cursor: move;">
                <!-- tools box -->
                <div class="pull-right box-tools">
                    <button type="button" class="btn btn-primary btn-sm pull-right" data-toggle="collapse" href="#collapseTra" role="button" aria-expanded="false" aria-controls="collapseTra" style="margin-right: 5px;" data-original-title="Collapse">
                        <i class="fa fa-minus"></i></button>
                </div>
                <!-- /. tools -->
                <i class="fa fa-map-marker"></i>
                <h3 class="box-title">
                    Filtros de Busqueda
                </h3>
            </div>
            <div class="box-body collapse" style="background-color: white;" id="collapseTra">
                <div class="col-xs-12">

                    <div class="col-xs-4">
                        <h style="font-size: 14px;color: black;font-weight: bold;height: 20px;">Nombre</h>
                        <input type="text" class="form-control" name="" id="nombreParamTra" style="width: 100%;" />
                    </div>
                    <div class="col-xs-4">
                        <h style="font-size: 14px;color: black;font-weight: bold;">Identificación</h>
                        <input type="text" class="form-control" name="" id="cedParamTra" style="width: 100%;" />
                    </div>
                    <div class="col-xs-4">
                        <h style="font-size: 14px;color: black;font-weight: bold;">Fecha Vigencia</h>
                        <div class="input-daterange input-group" id="datepicker" style="">
                            <input type="text" class="input-sm form-control" name="start" id="FdesdeParamTra" />
                            <span class="input-group-addon" style="border:none;font-weight: bold;">a</span>
                            <input type="text" class="input-sm form-control" name="end" id="FhastaParamTra" />
                        </div>
                        <br>
                        <button type="button" class="btn btn-block btn-success" style="width: 20%; float: right;" onclick="buscarTraspasoParametros();">Buscar</button>
                    </div>

                </div>
            </div>
            <!-- /.box-body-->
        </div>

        <div class="col-md-12">
            <div class="col-md-9"></div>
            <div class="col-md-3">
                <div class="box box-default" style="position: relative;top: 10px; float: right;right: -10%;">
                    <div class="box-header with-border" style="cursor: move;">
                        <!-- tools box -->
                        <div class="pull-right box-tools">
                            <button type="button" class="btn btn-primary btn-sm pull-right" data-toggle="collapse" href="#collapseTableT" role="button" aria-expanded="false" aria-controls="collapseTableT" style="margin-right: 5px;" data-original-title="Collapse">
                                <i class="fa fa-minus"></i></button>
                        </div>
                        <!-- /. tools -->
                        <i class="fa fa-search"></i>
                        <h3 class="box-title">
                    Ver Ocultar Columnas
                  </h3>
                    </div>
                    <div class="box-body collapse" style="background-color: white;" id="collapseTableT">
                        <div class="col-xs-12" align="left" style="box-shadow: 0px 5px 5px 0px;" id="filterTableT">

                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="box-body">

            <table id="tabla_traslado_SP" style="font-size: 10px; text-transform: uppercase;" class="table table-striped table-bordered" width="100%" cellspacing="0">
                <thead>
                    <tr class="bg-light-blue-gradient" style="color: white;">
                        <th>FECHA CREACIÓN</th>
                        <th>#ACCIÓN</th>
                        <th>IDENTIFICACIÓN</th>
                        <th>NOMBRE</th>
                        <th>TIPO</th>
                        <th>ISLA TRABAJA</th>
                        <th>ESTADO</th>
                        <th>FECHA DESDE</th>
                        <th>CAMBIO ADMINISTRATIVO
                            <BR>MESES O DIAS</th>
                        <th>FECHA HASTA</th>
                        <th>PUESTO ACTUAL</th>
                        <th>PUESTO PROPUESTO</th>
                        <th>OBSERVACIÓN</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody class="botonera1" id="bodytabla_traslado_SP">

                </tbody>
            </table>
        </div>
        <!-- /.box-body -->

    </div>

</div>
<!-- /.box -->
<!-- AdminLTE datatable -->
<!-- jQuery 3 -->
<!-- esta pendiente realizar el historial de encargos y los eccargos activos por empleado -->
{% load static %}
<input type="hidden" id="verifica_init_traslado" value=0>
<script src="{% static 'js/lib_internas/script.js' %}"></script>
<script>
    $(document).ready(function() {

        dataCabFla = ['Fecha Creacion', '#Accion', 'Identificacion', 'Nombre', 'Tipo', 'Isla Trabajo', 'Estado', 'Fecha Desde', 'Meses o Dias', 'Fecha Hasta', 'Puesta Actual', 'Puesto Propuesto', 'observacion'];
        dataDisableFla = [8, 10, 11, 12];
        intFilterTabla('filterTableT', dataCabFla, dataDisableFla);
        $('input[type="checkbox"].flat-red, input[type="radio"].flat-red').iCheck({
            checkboxClass: 'icheckbox_flat-green',
            radioClass: 'iradio_flat-green'
        })

        var d = new Date();
        var f1 = d.getFullYear() + "-01-01";
        //var f2 = d.getFullYear()+"-"+(d.getMonth()+1)+"-"+ d.getDate();
        var f2 = d.getFullYear() + "-12-31";
        var dataini = f1 + "," + f2;
        buscarTraspasoParametros(dataini);

        f1_aux = '01/01/' + d.getFullYear();
        //f2_aux = (d.getMonth()+1)+'/'+d.getDate()+'/'+ d.getFullYear();
        f2_aux = '12/31/' + d.getFullYear();
        $("#FdesdeParamTra").val(f1_aux);
        $("#FhastaParamTra").val(f2_aux);

        //sortSelect('#SfuncionarioT', 'text', 'asc');
        $("#SfuncionarioT").select2({
            sorter: data => data.sort((a, b) => a.text.localeCompare(b.text)),
        });

        $("#SdireccionT").select2({
            disabled: true
        });
        $("#SprocesoT").select2({
            disabled: true
        });
        $("#SsubprocesoT").select2({
            disabled: true
        });
        $("#SpuestoT").select2({
            disabled: true
        });
        $("#SpuestoDistT").select2({
            disabled: true
        });

        $("#ScargoT").select2();

        var table = $('#tabla_traslado_SP').DataTable({
            orderCellsTop: true,
            "order": [
                [0, "desc"]
            ],
        });

        $('.input-daterange').datepicker();

    });
</script>

{% endblock %}