{% extends 'cuso_controlmarino/menu_lateral.html' %}
{% block principalhome %}
{% load static %} 
<!-- DataTables -->
<link rel="stylesheet" type="text/css" href="{% static 'css/select2.min.css' %}">

<style type="text/css">
.break-page {break-after: page;}

.tox .tox-menubar {
    background-color: #005196; 
}
.tox .tox-toolbar, .tox .tox-toolbar__overflow, .tox .tox-toolbar__primary {
    background-color: #005196;
}

.select2{
    z-index: 0;
}
    .tabs-left > .nav-tabs {
  border-bottom: 0;
}

.tab-content > .tab-pane,
.pill-content > .pill-pane {
  display: none;
}

.tab-content > .active,
.pill-content > .active {
  display: block;
  background-color: #0073b;
  color: white;
}

.tabs-left > .nav-tabs > li {
  float: none;
}

.tabs-left > .nav-tabs > li > a {
  min-width: 74px;
  margin-right: 0;
  margin-bottom: 3px;
}

.tabs-left > .nav-tabs {
  float: left;
  margin-right: 19px;
  border-right: 2px solid #000;
}

.tabs-left > .nav-tabs > li > a {
  margin-right: -1px;
  -webkit-border-radius: 4px 0 0 4px;
     -moz-border-radius: 4px 0 0 4px;
          border-radius: 4px 0 0 4px;
}

.tabs-left > .nav-tabs > li > a:hover,
.tabs-left > .nav-tabs > li > a:focus {
  border-color: #eeeeee #dddddd #eeeeee #eeeeee;
  background-color: #8a8a8a;
  color: white;
}

.tabs-left > .nav-tabs .active > a,
.tabs-left > .nav-tabs .active > a:hover,
.tabs-left > .nav-tabs .active > a:focus {
  border-color: #fff transparent #fff #fff;
  border-right-color: #36c308;
}

.nav-tabs>li.active>a, .nav-tabs>li.active>a:hover, .nav-tabs>li.active>a:focus {
    color: #fff;
    background-color: #005196;
    border: 2px solid #ddd;
    border-bottom-color: transparent;
    cursor: default;
}
fieldset {
    border: 1px solid #000 !important;
    margin: 0;
    xmin-width: 0;
    padding: 10px;
    position: relative;
    border-radius: 4px;
    padding-left: 10px!important;
}
legend {
    font-size: 14px;
    font-weight: bold;
    margin-bottom: 0px;
    width: 35%;
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 5px 5px 5px 10px;
    background-color: #ffffff;
}

.ui-dialog .ui-dialog-titlebar {
    background-color: #005196;
    color: white;
}

.ui-window-bar .ui-button {
  position: absolute;
  top: 50%;
  width: 20px;
  margin: -10px 0 0 0;
  padding: 1px;
  height: 20px;
}

.ui-window-bar .ui-window-minimize {
  right: calc(.3em + 40px);
}

.ui-window-bar .ui-window-maximize {
  right: calc(.3em + 20px);
}

.ui-dialog {
    z-index: 9999999;
}
.tab-content > .active, .pill-content > .active {
    color: black;
}
.notificacion{
    z-index: 9999999999;
}
a{
    cursor: pointer;
}
</style>
<link rel="stylesheet" href="{% static 'css/style.min.css' %}" />
<!-- FORMULARIO  -->

<div style="width: 98%; margin-left: 1%;box-shadow: 5px 5px 15px 5px #888888;">
<div id="content_actar" style="position: relative;">
    
    <div class="box">

        <div class="box-header" id="actar" style="background-color: #005196; color: white;">
            <i class="fa fa-list"></i>
            <h3 class="box-title">Acta de Retención<i class="fa fa-book" aria-hidden="true" style="font-size: 20px; margin-left: 10px;"></i></h3>
            <div class="input-group" style="width: 500px;position: relative;float: right;">
                <table>
                    <td align="right" style="color:white;">Fechas</td>
                    <td width="10px"></td>
                    <td>
                        <div class="input-daterange input-group" id="datepicker" style="">
                            <input type="text" autocomplete="off" class="input-sm form-control" name="start" id="FdesdeAR" />
                            <span class="input-group-addon" style="border:none;font-weight: bold;">a</span>
                            <input type="text" autocomplete="off" class="input-sm form-control" name="end" id="FhastaAR" />
                        </div>
                    </td>
                </table>
                <div class="input-group-addon">
                    <a onclick="" style="cursor: pointer;">
                        <i class="fa fa-search"></i>
                    </a>
                </div>
            </div>            
        </div>
        <!-- /.box-header -->
        <div class="box-body" id="bodyactar">
            <div class="row">
                <div class="btn-group-vertical" style="position: absolute; z-index: 99999; right: 0%;top: 25%;">
                    <button style="border-radius: 50%;width: 40px;height: 40px;box-shadow: 5px 5px 5px black;" type="button" class="btn btn-success" onclick="limpiarFormactaRetencionCuso();" title="Nuevo Reporte"><i class="fa fa-plus"></i></button>
                    <button style="border-radius: 50%;width: 40px;height: 40px;box-shadow: 5px 5px 5px black;margin-top: 10px;" type="button" onclick="setInsertUpdateActaRetencionCuso();" class="btn btn-success" title="Grabar"><i class="fa fa-floppy-o"></i></button>
                    <button style="border-radius: 50%;width: 40px;height: 40px;box-shadow: 5px 5px 5px black;margin-top: 10px;" type="button" class="btn btn-success" title="PDF" onclick=""><i class="fa fa-download"></i></button>
                    <button style="border-radius: 50%;width: 40px;height: 40px;box-shadow: 5px 5px 5px black;margin-top: 10px;" type="button" class="btn btn-success" title="PDF" onclick='deleteActaRetencion("actaretencion");'><i class="fa fa-trash"></i></button>
                </div>
                <div class="notification">
                    <span class="icon">
                        <i class=""></i>
                    </span>
                    <span class="text"></span>
                    <span class="close"><i class="fa fa-close"></i></span>
                </div>
                <div class="col-xs-2" style="background-color: #f3f3f3;height: 555px;border: 2px solid black;left: 0.5%;">
                    <input id="search-input" class="search-input" style="margin-top: 10px;" />
                    <div id="html" class="demo" style="font-weight: bold;">

                    </div>
                </div>
                <!--div class="col-xs-1"></div-->
                <div class="col-xs-10" style="border: 2px solid black;height: 555px;background-color: #f3f3f3; width: 81%; left: 20px;" id="content_divTab">
                    <div style="height: 10px;"></div>
                    <div class="tabbable tabs-left nav-stacked" style="">
                                <ul class="nav nav-tabs" id="tabsIng" style="height: 500px;">
                                    <br>
                                    <li class="active">
                                        <a href="#tab_Gen" data-toggle="tab" aria-expanded="true" style="font-weight: bold; font-size: 12px;">Datos<br>Acta</a>
                                    </li>
                                    <li class=""><a href="#tab_part" data-toggle="tab" aria-expanded="false" style="font-weight: bold; font-size: 12px;" >Personas Participantes</a></li>
                                    <li class=""><a href="#tab_desc" data-toggle="tab" aria-expanded="false" style="font-weight: bold; font-size: 12px;" >Descripción</a></li>
                                    <li class=""><a href="#tab_impl" data-toggle="tab" aria-expanded="false" style="font-weight: bold; font-size: 12px;" >Personas Implicadas</a></li>
                                    <br><br>
                                </ul>
                                <div class="tab-content" style="">
                                    <div class="tab-pane active" id="tab_Gen">
                                        <div class="col-xs-9">
                                            <fieldset style="height: 500px;">
                                                <legend style="font-size: 14px; text-align: left;border-bottom: 1px solid;background-color: #005196;color: white;padding: 5px; width: 50%;">Datos Informe de Novedades</legend>
                                            <table style="width: 100%;color: black;font-weight: bold;margin-top: 50px;">
                                                <input type="hidden" id="idActaR" name="idActaR" value="" />
                                                <input type="hidden" id="tipoAR" name="tipoAR" value="0" />
                                                <tr height='10px;'></tr>
                                                <tr>
                                                    <td align="right" colspan="7">Nro.<input type="text" id="nroAR" class="form-control" style="width: 100px;background-color:#868686; color: white; text-align: center;" readonly/></td>
                                                </tr>
                                                <tr height='10px;'></tr>
                                                <tr>
                                                    <td align="right" style="width: 200px;">*Info Novedades</td>
                                                    <td width="20px;"></td>
                                                    <td colspan="4">
                                                        <input type="text" id="infoNovAR" class="form-control requerido" text="Info Novedades" style="width: 100%;" readonly />
                                                        <input type="hidden" id="idinfoNovAR" />
                                                    </td>
                                                    <td>
                                                        <a style="cursor: pointer; font-size: 16px;float: right;" title="Buscar Acta Retencion" href='#popupActaRet' onclick="limpiaPopupActaRet('acta_retencion');" data-stackbox='true' data-stackbox-width="1000px" data-stackbox-height="300px" data-stackbox-position="absolute"><i class="fa fa-search-plus text-green"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                                <tr height='10px;'></tr>
                                                <tr>
                                                    <td align="right">Isla Sitio</td>
                                                    <td width="20px;"></td>
                                                    <td colspan="4">
                                                        <input type="text" id="sitioAR" class="form-control" readonly style="width: 100%;"/>
                                                        <input type="hidden" id="idsitioAR" readonly/>
                                                    </td>
                                                </tr>
                                                <tr height='10px;'></tr>
                                                <tr>
                                                    <td align="right">Fecha</td>
                                                    <td width="20px;"></td>
                                                    <td>
                                                        <input type="text" id="fechaAR" class="form-control" style="width: 100%;"/>
                                                    </td>
                                                </tr>
                                                <tr height='10px;'></tr>
                                                <tr>
                                                    <td align="right">Tipo Retencion</td>
                                                    <td width="20px;"></td>
                                                    <td>
                                                        <select id="tiporetAR" class="select2" style="width: 200px;">
                                                            <option value=""></option>
                                                            <option value="1">Por Coincidencia</option>
                                                            <option value="2">Patrullaje Regular</option>
                                                            <option value="3">Patrullaje Especial</option>
                                                        </select>
                                                    </td>
                                                </tr> 
                                                <tr height='10px;'></tr>
                                                <tr>
                                                    <td align="right">Testigo</td>
                                                    <td width="20px;"></td>
                                                    <td>
                                                        <input type="text" id="testigoAR" class="form-control" style="width: 100%;" readonly="" />
                                                        <input type="hidden" id="idtestigoAR"/>
                                                    </td>
                                                    <td>
                                                        <a style="cursor: pointer; font-size: 16px;position: relative;float: right; right: 5px;" title="Buscar Personas" href='#popupPersonasCuso' onclick="document.getElementById('pagina_enviaPopPercuso').value='acta_retencionTest';cleanBodyTablePersona();" data-stackbox='true' data-stackbox-position="absolute">
                                                            <i class="fa fa-search-plus text-green"></i>
                                                        </a>                  
                                                    </td>
                                                </tr>                         
                                                <tr height='20px;'></tr>
                                            </table>
                                            </fieldset>
                                        </div>
                                        
                                    </div><!--div tab_Gen-->
                                    <div class="tab-pane" id="tab_part">
                                        <div class="col-xs-9">
                                            <fieldset style="height: 500px;">
                                                <legend style="font-size: 14px; text-align: left;border-bottom: 1px solid;background-color: #005196;color: white;padding: 5px; width: 50%;">Participantes</legend>
                                                <div align="center" style="height: 500px; overflow-y: auto;">
                                                    <div class="col-xs-12"><span style="position: relative;float: right; right: 5px;font-weight: bold;">Agregar Participantes DPNG</span>
                                                        <a style="cursor: pointer; font-size: 16px;position: relative;float: right; right: 5px;" title="Buscar Funionario" href='#popupFuncionarios' onclick="limpiaPopupFuncionario('acta_retencion')" data-stackbox='true' data-stackbox-width="1000px" data-stackbox-height="300px" data-stackbox-position="absolute"><i class="fa fa-search-plus text-green"></i>
                                                        </a>
                                                    </div>
                                                    <br>
                                                    <div lass="col-xs-12"><span style="position: relative;float: right; right: 5px;font-weight: bold;">Agregar Participantes Armada</span>
                                                        <a style="cursor: pointer; font-size: 16px;position: relative;float: right; right: 5px;" title="Buscar Personal Armada" href='#popupPersonasCuso' onclick="document.getElementById('pagina_enviaPopPercuso').value='acta_retencion';cleanBodyTablePersona();" data-stackbox='true' data-stackbox-position="absolute">
                                                            <i class="fa fa-search-plus text-green"></i>
                                                        </a>
                                                    </div>
                                                    <br><br>
                                                    <table id="tabla_participantes" style="font-size: 10px; text-transform: uppercase;font-weight: bold; color: black;" class="table table-striped table-bordered" width="95%">
                                                        <thead style="background-color: #005196; color: white; text-align: center;">
                                                            <th>Nombre</th>
                                                            <th>Cedula</th>
                                                            <th>Institucion</th>
                                                            <th></th>
                                                        </thead>
                                                        <tbody id="bodytabla_participantes">

                                                        </tbody>
                                                       
                                                   </table>
                                                </div>
                                            </fieldset>      
                                        </div>
                                    </div><!--tab_intro-->
                                    <div class="tab-pane" id="tab_desc">
                                        <div align="center" class="col-xs-9">
                                            <fieldset style="height: 500px;">
                                                <legend style="font-size: 14px; text-align: left;border-bottom: 1px solid;background-color: #005196;color: white;padding: 5px; width: 100%;">Descripción</legend>
                                                <fieldset>
                                                    <table style="width: 80%;color: black;">
                                                        <tr style="height: 10px;"></tr>
                                                        <tr>
                                                            <td style="margin-left: 5px;padding-left: 5px;">
                                                                <b>Producto:</b>
                                                                <!--input type="text" id='nombre_desAR' class="form-control" /-->
                                                                <select id="SproductoAR" class="select2" style="width: 200px;">
                                                                {% for producto in productos %} 
                                                                    <option value="{{ producto.id }}">{{ producto.descripcion }}</option> 
                                                                {% endfor %}
                                                                </select>  
                                                            </td>
                                                            <td style="width: 20px;"></td>
                                                            <td style="margin-left: 5px;padding-left: 5px;">
                                                                <b>Unidades:</b>
                                                                <input type="text" id="cantidad_desAR" class="form-control" style="width: 50px;" onkeypress='return isNumberKey(event);'/>
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 10px;"></tr>
                                                        <tr>
                                                            <td style="margin-left: 5px;padding-left: 5px;">
                                                                <b>Tipo:</b>
                                                                <input type="text" id='tipo_desAR' class="form-control"  />
                                                            </td>
                                                            <td style="width: 20px;"></td>
                                                            <td style="margin-left: 5px;padding-left: 5px;">
                                                                <b>Estado:</b>
                                                                <input type="text" id="estado_desAR" class="form-control" />
                                                            </td>
                                                            <td style="float: right;"> <a style="cursor: pointer;position: relative;top: 20px;" onclick="insertarDescActaRet();" title="Agregar Descripciones"><i class="fa fa-plus-circle text-green btn_nuevo" style="font-size: 30px;"></i></a> 
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 10px;"></tr>
                                                    </table>
                                                </fieldset>
                                                <br>
                                                <p style="color: black; font-size: 14px; font-weight: bold;">Lista Descripciones</p>
                                                <div align="center" style="height: 500px; overflow-y: auto;">
                                                    
                                                    <table id="tabla_descripcion" style="font-size: 10px; text-transform: uppercase;font-weight: bold; color: black;" class="table table-striped table-bordered" width="95%">
                                                        <thead style="background-color: #005196; color: white; text-align: center;">
                                                            <th>Producto</th>
                                                            <th>Unidades</th>
                                                            <th>Tipo</th>
                                                            <th>Estado</th>
                                                            <th></th>
                                                        </thead>
                                                        <tbody id="bodytabla_descripcion">

                                                        </tbody>
                                                       
                                                   </table>
                                                </div>
                                            </fieldset> 
                                        </div>
                                    </div><!--tab_objet-->
                                    <div class="tab-pane" id="tab_impl">
                                        <div class="col-xs-9">
                                            <fieldset style="height: 500px;">
                                                <legend style="font-size: 14px; text-align: left;border-bottom: 1px solid;background-color: #005196;color: white;padding: 5px; width: 50%;">Implicados</legend>
                                                <div align="center" style="height: 500px; overflow-y: auto;">
                                                    <div lass="col-xs-12"><span style="position: relative;float: right; right: 5px;font-weight: bold;">Agregar Implicados Persona</span>
                                                        <a style="cursor: pointer; font-size: 16px;position: relative;float: right; right: 5px;" title="Buscar Funionario" href='#popupPersonasCuso' onclick="document.getElementById('pagina_enviaPopPercuso').value='acta_retencionImp';cleanBodyTablePersona();" data-stackbox='true' data-stackbox-position="absolute">
                                                            <i class="fa fa-search-plus text-green"></i>
                                                        </a>
                                                    </div>
                                                    <br>
                                                    <div class="col-xs-12"><span style="position: relative;float: right; right: 5px;font-weight: bold;">Agregar Implicados Parma</span>
                                                        <a style="cursor: pointer; font-size: 16px;position: relative;float: right; right: 5px;"  href='#popupParmas' onclick="limpiaPopupParma('acta_retencionImp');getDataParma(1);" data-stackbox='true' data-stackbox-position="absolute" data-stackbox-width="1000"><i class="fa fa-search-plus text-green"></i></a>
                                                    </div>
                                                    <br><br>
                                                    <table id="tabla_implicados" style="font-size: 10px; text-transform: uppercase;font-weight: bold; color: black;" class="table table-striped table-bordered" width="95%">
                                                        <thead style="background-color: #005196; color: white; text-align: center;">
                                                            <th  width="150px;">Licencia Parma</th>
                                                            <th>Nombre</th>
                                                            <th>Cedula</th>
                                                            <th>Presento<br>Resistencia</th>
                                                            <th>Observacion</th>
                                                            <th></th>
                                                        </thead>
                                                        <tbody id="bodytabla_implicados">

                                                        </tbody>
                                                       
                                                   </table>
                                                </div>
                                            </fieldset>      
                                        </div>
                                    </div><!--tab_objet-->
                                    
                                    
                                </div><!--tab-content-->
                    </div><!--nav-tabs-custom-->
                </div>
            </div>
        </div>
        <!-- /.box-body -->

    </div>
    <!-- /.box -->

</div>
</div>
<!-- /.content -->

<!-- AdminLTE datatable -->
<!-- jQuery 3 -->
{% load static %}
<!--link rel="stylesheet" type="text/css" href="{% static 'css/jquery.fancybox.min.css' %}">
<script src="{% static 'js/lib_internas/script_bsa.js' %}"></script>
<script src="{% static 'js/lib_externas/jstree.min.js' %}"></script>
<script src="{% static 'js/lib_externas/jquery.fancybox.min.js' %}"></script-->

<script>
    $(document).ready(function() {


        $("#idmenu6").addClass("fa-dot-circle-o");
        $("#idmenu6").parent().css("color", "#00c0ef");
        $("#tiporetAR").select2();
        $("#SproductoAR").select2();

        $('.input-daterange').datepicker();
        $('#tabla_participantes').DataTable({"destroy": true,});
        $('#tabla_implicados').DataTable({"destroy": true,});
        $('#tabla_descripcion').DataTable({"destroy": true,});

       
        
        var f1 = (new Date).getFullYear() + "-01-01";
        var f2 = (new Date).getFullYear() + "-12-31";
        var dataini = f1 + "," + f2;
        getActaRetencionCabCuso(dataini);

        $('#FdesdeAR').val("01/01/"+(new Date).getFullYear());
        $('#FhastaAR').val("12/31/"+(new Date).getFullYear());

    });
 
</script>

{% endblock %}